CREATE OR REPLACE TRANSIENT DATABASE TASK_DB;

// Prepare table CUSTOMERS
CREATE OR REPLACE TABLE CUSTOMERS (
    CUSTOMER_ID INT AUTOINCREMENT ,
    FIRST_NAME VARCHAR(40) DEFAULT 'JENNIFER' ,
    CREATE_DATE DATE,
    create_at timestamp default current_timestamp());
    
    
// Create task
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE'
    AS 
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);
    

SHOW TASKS;

// Task starting and suspending
ALTER TASK CUSTOMER_INSERT RESUME;
ALTER TASK CUSTOMER_INSERT SUSPEND;


SELECT * FROM CUSTOMERS
-----------------------------------------------------------------------
// Prepare corn table
CREATE OR REPLACE TABLE CUSTOMERS_CORN1 (
    CUSTOMER_ID INT AUTOINCREMENT START = 1 INCREMENT = 2,
    FIRST_NAME VARCHAR(40) DEFAULT 'CORN1' ,
    CREATE_DATE DATE,
    create_at timestamp default current_timestamp());

    CREATE OR REPLACE TASK CUSTOMER_CORN_TASK
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = 'USING CRON * * * * * UTC'
    AS 
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP);
    
SHOW TASKS;

// Task starting and suspending
ALTER TASK CUSTOMER_CORN_TASK RESUME;
ALTER TASK CUSTOMER_CORN_TASK SUSPEND;


SELECT * FROM CUSTOMERS_CORN1



